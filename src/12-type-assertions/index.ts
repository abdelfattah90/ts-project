/* =====================================================================================
 *                               Type Assertions & Non-null Assertion
 *                                   Ahmed â€“ Simplified Notes
 * ===================================================================================== */

/* ================================================================================
 * 1ï¸âƒ£ Ù…Ù‚Ø¯Ù…Ø© â€“ Type Assertions
 * -------------------------------------------------------------------------------
 * Type Assertions = Ø·Ø±ÙŠÙ‚Ø© Ù„Ø¥Ø®Ø¨Ø§Ø± TypeScript Ø¨Ø§Ù„Ù†ÙˆØ¹ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠ Ù„Ù„Ù‚ÙŠÙ…Ø© Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ†
 * Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯Ù‹Ø§ Ø£ÙƒØ«Ø± Ù…Ù† Ø§Ù„Ù…ØªØ±Ø¬Ù….
 * âš ï¸ Ù…Ù„Ø§Ø­Ø¸Ø© Ù…Ù‡Ù…Ø©: Assertions Ù„Ø§ ØªØ¶ÙŠÙ Ø£ÙŠ ÙØ­Øµ Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ Runtime.
 * Ù‡ÙŠ Ù…Ø¬Ø±Ø¯ ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ù…ØªØ±Ø¬Ù… ÙÙ‚Ø·.
 * ================================================================================ */

let value: any = "hello world";
let length = (value as string).length; // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¢Ù…Ù†

/* ================================================================================
 * 2ï¸âƒ£ Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ù…ÙˆØµÙ‰ Ø¨Ù‡ Ø¯Ø§Ø¦Ù…Ù‹Ø§: as Syntax
 * -------------------------------------------------------------------------------
 * ÙŠØ¹Ø¯ (as) Ø§Ù„Ø£Ø³Ù„ÙˆØ¨ Ø§Ù„Ø£ÙØ¶Ù„ ÙˆØ§Ù„Ø£ÙƒØ«Ø± Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‹Ø§ØŒ Ø®Ø§ØµØ© Ù…Ø¹ DOM.
 * ================================================================================ */

const emailInput = document.getElementById("email") as HTMLInputElement;
emailInput.value = "test@example.com";

/* ================================================================================
 * 3ï¸âƒ£ Angle Bracket Syntax <Type> ÙˆÙ„Ù…Ø§Ø°Ø§ Ù†ØªØ¬Ù†Ø¨Ù‡Ø§
 * -------------------------------------------------------------------------------
 * Ø§Ù„ØµÙŠØºØ© Ø§Ù„ØªØ§Ù„ÙŠØ© ØªØ¹Ù…Ù„:
 *   let len = (<string>msg).length
 * Ù„ÙƒÙ† âš ï¸ ØªØ¬Ù†Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§ ÙÙŠ React/JSX Ø£Ùˆ Angular.
 * ================================================================================ */

let msg: any = "hello";
let len = (msg as string).length;

/* ================================================================================
 * 4ï¸âƒ£ Assertions Ù…Ø¹ Union Types
 * -------------------------------------------------------------------------------
 * Ù‚Ø¯ ÙŠØ¤Ø¯ÙŠ Ø§Ø³ØªØ®Ø¯Ø§Ù… Assertions Ù…Ø¨Ø§Ø´Ø±Ø© Ù…Ø¹ Union Types Ø¥Ù„Ù‰ Ø£Ø®Ø·Ø§Ø¡.
 * Ø§Ù„Ø£ÙØ¶Ù„ Ù‡Ùˆ Type Guards.
 * ================================================================================ */

type Result = { success: true; data: string } | { success: false; error: string };

function unsafe(result: Result) {
    const r = result as { success: true; data: string }; // âš ï¸ Ù…Ù…ÙƒÙ† ÙŠØ¤Ø¯ÙŠ Ù„Ø®Ø·Ø£
    console.log(r.data);
}

// âœ”ï¸ Ø§Ù„Ø£ÙØ¶Ù„
function safe(result: Result) {
    if (result.success) console.log(result.data);
}

/* ================================================================================
 * 5ï¸âƒ£ Assertions Ù…Ø¹ DOM
 * -------------------------------------------------------------------------------
 * Ù…Ù† Ø£Ø´Ù‡Ø± Ø£Ù…Ø§ÙƒÙ† Ø§Ø³ØªØ®Ø¯Ø§Ù… Type Assertions.
 * ================================================================================ */

const usernameInput = document.querySelector("#username") as HTMLInputElement;
const formElement = document.querySelector("form") as HTMLFormElement;

usernameInput.value = "Ahmed";
formElement.onsubmit = (e) => e.preventDefault();

/* ================================================================================
 * 6ï¸âƒ£ Double Assertions (rare)
 * -------------------------------------------------------------------------------
 * ØªØ­ÙˆÙŠÙ„ Ù†ÙˆØ¹ Ù„Ù†ÙˆØ¹ Ø¢Ø®Ø± ØºÙŠØ± Ù…ØªÙˆØ§ÙÙ‚.
 * Ù†Ø§Ø¯Ø± Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… âš ï¸.
 * ================================================================================ */

interface Cat { meow(): void }
interface Dog { bark(): void }

let pet = {} as Dog;
let c = pet as unknown as Cat; // âš ï¸ Ø®Ø·ÙŠØ± Ø¬Ø¯Ù‹Ø§

/* ================================================================================
 * 7ï¸âƒ£ Const Assertions (as const)
 * -------------------------------------------------------------------------------
 * ÙŠØ­ÙˆÙ„ Ø§Ù„Ù‚ÙŠÙ… Ø¥Ù„Ù‰ literal types ÙˆÙŠØ¬Ø¹Ù„Ù‡Ø§ readonly.
 * ================================================================================ */

const COLORS = ["red", "green", "blue"] as const;

const CONFIG = {
    host: "localhost",
    port: 3000,
} as const;

/* ================================================================================
 * 8ï¸âƒ£ Non-null Assertion Operator (!)
 * -------------------------------------------------------------------------------
 * ÙŠØ®Ø¨Ø± TypeScript Ø£Ù† Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„ÙŠØ³Øª null.
 * âš ï¸ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ù‚ÙŠÙ…Ø© null ÙØ¹Ù„ÙŠÙ‹Ø§ â†’ Ø³ÙŠØ­Ø¯Ø« Runtime Error.
 * ================================================================================ */

function process(v: string | null) {
    console.log(v!.toUpperCase()); // ğŸ”¥ Ø§Ø³ØªØ®Ø¯Ù… Ø¨Ø­Ø°Ø±
}

/* ================================================================================
 * 9ï¸âƒ£ Non-null Assertion Ù…Ø¹ DOM
 * -------------------------------------------------------------------------------
 * Ø´Ø§Ø¦Ø¹ Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ù…ØªØ£ÙƒØ¯Ù‹Ø§ Ø£Ù† Ø§Ù„Ø¹Ù†ØµØ± Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙØ­Ø©.
 * ================================================================================ */

const input2 = document.querySelector<HTMLInputElement>("#email")!;
input2.value = "test@example.com";

/* ================================================================================
 * ğŸ”Ÿ Ù…ØªÙ‰ Ù†Ø³ØªØ®Ø¯Ù… Assertions ÙˆÙ…ØªÙ‰ Ù†ØªØ¬Ù†Ø¨Ù‡Ø§
 * -------------------------------------------------------------------------------
 * âœ… Ø§Ø³ØªØ®Ø¯Ù… Assertions:
 *    - Ø¹Ù†Ø¯Ù…Ø§ ØªÙƒÙˆÙ† Ù…ØªØ£ÙƒØ¯Ù‹Ø§ 100% Ù…Ù† Ø§Ù„Ù†ÙˆØ¹.
 * âŒ ØªØ¬Ù†Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù…Ù‡Ø§:
 *    - Ù„Ø¥Ø®ÙØ§Ø¡ Ø£Ø®Ø·Ø§Ø¡ TypeScript.
 *    - Ø¹Ù†Ø¯ ÙˆØ¬ÙˆØ¯ Ø­Ù„ÙˆÙ„ Ø£ÙØ¶Ù„ Ù…Ø«Ù„ Type Guards.
 * ================================================================================ */

const data = { id: 1 };
// const u = data as User; // âŒ Ø®Ø·Ø£ Ø´Ø§Ø¦Ø¹

/* ================================================================================
 * 1ï¸âƒ£1ï¸âƒ£ Assertions ÙÙŠ Angular
 * -------------------------------------------------------------------------------
 * Ø§Ø³ØªØ®Ø¯Ø§Ù…Ø§Øª Ø´Ø§Ø¦Ø¹Ø© Ø¯Ø§Ø®Ù„ ViewChild Ø£Ùˆ event.target.
 * ================================================================================ */

class ExampleComponent {
    onClick(event: Event) {
        const btn = event.target as HTMLButtonElement;
        btn.disabled = true;
    }
}

/* ================================================================================
 * 1ï¸âƒ£2ï¸âƒ£ Assertions vs Type Guards
 * -------------------------------------------------------------------------------
 * Type Guards Ø£ÙØ¶Ù„ Ù„Ø£Ù†Ù‡Ø§ ØªØ¶ÙŠÙ Ø­Ù…Ø§ÙŠØ© Runtime.
 * ================================================================================ */

interface Cat2 { type: "cat"; meow(): void }
interface Dog2 { type: "dog"; bark(): void }
type Pet2 = Cat2 | Dog2;

function isCat(pet: Pet2): pet is Cat2 {
    return pet.type === "cat";
}

function makeSound(pet: Pet2) {
    if (isCat(pet)) pet.meow(); else pet.bark();
}

/* ================================================================================
 * 1ï¸âƒ£3ï¸âƒ£ Satisfies Operator (TypeScript 4.9+)
 * -------------------------------------------------------------------------------
 * ÙŠØ­Ø§ÙØ¸ Ø¹Ù„Ù‰ literal types ÙˆÙŠØªØ£ÙƒØ¯ Ù…Ù† ØªÙˆØ§ÙÙ‚ Ø§Ù„Ù†ÙˆØ¹.
 * ================================================================================ */

type ApiConfig = { host: string; port: number };

const apiConfig = {
    host: "localhost",
    port: 3000,
} satisfies ApiConfig;

/* ================================================================================
 * 1ï¸âƒ£4ï¸âƒ£ Ù…Ø«Ø§Ù„ Ø¹Ù…Ù„ÙŠ Ø´Ø§Ù…Ù„ â€“ Ù…Ø®ØªØµØ±
 * -------------------------------------------------------------------------------
 * Ù…Ø«Ø§Ù„ Ø¨Ø³ÙŠØ· Ø¹Ù„Ù‰ Assertions Ø¯Ø§Ø®Ù„ Ù†Ù…ÙˆØ°Ø¬ form.
 * ================================================================================ */

interface FormField {
    value: string;
    error?: string;
}

class SimpleForm {
    private fields: Record<string, FormField> = {};

    constructor(names: string[]) {
        names.forEach(n => this.fields[n] = { value: "" });
    }

    setValue(name: string, value: string) {
        const field = this.fields[name]!; // Non-null assertion
        field.value = value;
    }

    getValues<T extends Record<string, any>>() {
        return this.fields as unknown as T; // Assertion Ø¢Ù…Ù† Ø¹Ù†Ø¯ Ù…Ø¹Ø±ÙØ© Ø§Ù„Ø´ÙƒÙ„
    }
}
